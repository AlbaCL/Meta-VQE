from matplotlib import pyplot as plt
import numpy

import matplotlib
import sys

font = {'weight' : 'normal',
        'size'   : 14}

matplotlib.rc('font', **font)
matplotlib.rcParams.update({'figure.autolayout': True})


def do_plot(data, filename=None, filetype="pdf", title=None):
    if filename is not None and "." in filename:
        filename = filename.split(".")[0]
    

    plt.figure()
    plt.xlabel("Intermolecular Distance/Angstrom")
    plt.ylabel("Energy/Eh")
    for name, points in data.items():
        plt.plot(list(points.keys()), list(points.values()), label=name, marker="o", markersize=8)
    plt.legend()
    if filename is not None:
        plt.savefig("{}_absolute_energies.{}".format(filename, filetype))
    else:
        plt.show()

    plt.figure()
    if title is not None:
        plt.title(title)
    plt.xlabel(r"Intermolecular Distance/$\operatorname{{\AA}}$")
    plt.ylabel("Error/mEh")
    for name, points in data.items():
        if name == "exact":
            continue
        refs = data["exact"]
        if "meta" in name:
            plt.plot(list(points.keys()), 1000*(numpy.asarray(list(points.values())) - numpy.asarray(list(refs.values()))), label=name, marker="o", markersize=8)
        else:
            plt.plot(list(points.keys()), 1000*(numpy.asarray(list(points.values())) - numpy.asarray(list(refs.values()))), label=name, marker="x", markersize=5)
    plt.legend(loc="upper right")
    if filename is not None:
        plt.savefig("{}.{}".format(filename, filetype))
    else:
        plt.show()


filename="h4_compressed"

data = {
"VQE0": {0.25: -0.5243498728852005, 0.305: -1.136652484444927, 0.36: -1.512961906555054, 0.415: -1.750420100314844, 0.47: -1.900613335031772, 0.5: -1.9568941172878092, 0.525: -1.9931692833564378, 0.58: -2.04625403825343, 0.635: -2.0716816498790998, 0.69: -2.0775150644465183, 0.745: -2.069429360442419, 0.8: -2.0514664883078195, 0.855: -2.026501005626775, 0.9099999999999999: -1.9965676659241085, 0.9650000000000001: -1.9631112455053392, 1.0: -1.940477063850444, 1.02: -1.927177599904748, 1.075: -1.8895521515781448, 1.13: -1.8508522333173403, 1.185: -1.8115829415773024, 1.24: -1.7851794894428128, 1.295: -1.814693804219165, 1.35: -1.8401391196558858, 1.405: -1.8620606669875828, 1.46: -1.880929519883592, 1.5: -1.8929704535401888, 1.5150000000000001: -1.897154385304788, 1.5699999999999998: -1.9110905838838195, 1.625: -1.9230472513211359, 1.6800000000000002: -1.9332933421170515, 1.735: -1.9420627602301492, 1.79: -1.9495588041087188, 1.845: -1.9559580425681613, 1.9: -1.9614137020592102, 1.955: -1.9660586280111718, 2.0: -1.9693368961507023, 2.01: -1.9700078737322233, 2.0650000000000004: -1.9733609646361048, 2.12: -1.976203880666218, 2.175: -1.9786107947461864, 2.23: -1.9806455997792707, 2.285: -1.9823632515175995, 2.34: -1.9838109498986216, 2.395: -1.9850291775053845, 2.45: -1.9860526107576337, 2.5: -1.9868390177930144, 2.505: -1.9869109172351698, 2.56: -1.9876294510206263, 2.6149999999999998: -1.9882298569155514, 2.67: -1.9887305936374922, 2.725: -1.9891473854757193, 2.7800000000000002: -1.989493611259538, 2.835: -1.989780638818349, 2.8899999999999997: -1.9900181123714176, 2.945: -1.9902141994889533},
"meta-VQE":{0.25: -0.5246263157583785, 0.305: -1.138574993723961, 0.36: -1.5167691622245154, 0.415: -1.7562863661918544, 0.47: -1.9086751595900227, 0.5: -1.9662010264623755, 0.525: -2.003535607957492, 0.58: -2.059010365727492, 0.635: -2.086894782166211, 0.69: -2.0952389880858306, 0.745: -2.0897113547039483, 0.8: -2.0743524245729117, 0.855: -2.052038961943524, 0.9099999999999999: -2.0248094025659213, 0.9650000000000001: -1.994111685827134, 1.0: -1.9732623369418232, 1.02: -1.9609929818377259, 1.075: -1.9262377413543157, 1.13: -1.8904603731299723, 1.185: -1.8541618480576436, 1.24: -1.8301351619302881, 1.295: -1.859165419490493, 1.35: -1.8841142381584546, 1.405: -1.9055284682657812, 1.46: -1.9238806761544407, 1.5: -1.9355407858749039, 1.5150000000000001: -1.9395809147211638, 1.5699999999999998: -1.9529856158760202, 1.625: -1.9644047011312487, 1.6800000000000002: -1.9741075351320692, 1.735: -1.9823280576642017, 1.79: -1.9892692702477055, 1.845: -1.9951071751102403, 1.9: -1.999994230854189, 1.955: -2.0040623771649773, 2.0: -2.006861963199415, 2.01: -2.0074256771913284, 2.0650000000000004: -2.0101826242065193, 2.12: -2.0124181562601096, 2.175: -2.0142054182692135, 2.23: -2.015607305822342, 2.285: -2.0166778195751975, 2.34: -2.017463254115312, 2.395: -2.018003240953105, 2.45: -2.0183316620100387, 2.5: -2.0184710645670325, 2.505: -2.0184774475813354, 2.56: -2.0184652710908564, 2.6149999999999998: -2.018316151816024, 2.67: -2.018047975933664, 2.725: -2.0176759455519284, 2.7800000000000002: -2.0172129647295134, 2.835: -2.0166699707817743, 2.8899999999999997: -2.016056218410765, 2.945: -2.015379523389053},
"opt-meta-VQE": {0.25: -0.5314238246645661, 0.305: -1.1445101102861106, 0.36: -1.521729504108822, 0.415: -1.7602388084212675, 0.47: -1.9116485043931226, 0.5: -1.9686703533145595, 0.525: -2.0056076470811743, 0.58: -2.060299874509349, 0.635: -2.087557175859043, 0.69: -2.0954647501726393, 0.745: -2.089727332567067, 0.8: -2.0744298554791363, 0.855: -2.0525036298579504, 0.9099999999999999: -2.0260684855231457, 0.9650000000000001: -1.9967009553721755, 1.0: -1.9770738713106788, 1.02: -1.9656755243722919, 1.075: -1.9342460476121441, 1.13: -1.9042108586066417, 1.185: -1.8797742954035368, 1.24: -1.870828872385518, 1.295: -1.8807471872718218, 1.35: -1.8977381924690402, 1.405: -1.9150098506572162, 1.46: -1.9307591388847538, 1.5: -1.9410416218653777, 1.5150000000000001: -1.944641348161715, 1.5699999999999998: -1.956696764696816, 1.625: -1.9670840084937786, 1.6800000000000002: -1.9759885185629997, 1.735: -1.9835895284328617, 1.79: -1.9900617445500277, 1.845: -1.9955589823387576, 1.9: -2.000210505756786, 1.955: -2.004135806655528, 2.0: -2.0068787735135323, 2.01: -2.0074377516766777, 2.0650000000000004: -2.010209122419367, 2.12: -2.012526178361938, 2.175: -2.0144558917386823, 2.23: -2.0160567574934167, 2.285: -2.0173786486482963, 2.34: -2.01846435917578, 2.395: -2.019350537661566, 2.45: -2.020068514349787, 2.5: -2.020601246593612, 2.505: -2.0206485268671237, 2.56: -2.0211074435281065, 2.6149999999999998: -2.0214672221211427, 2.67: -2.0217443249955207, 2.725: -2.021952714336779, 2.7800000000000002: -2.022104212429733, 2.835: -2.0222088114401475, 2.8899999999999997: -2.022274939116206, 2.945: -2.022309688617285},
"VQE": {0.25: -0.5314238931462648, 0.305: -1.144510148207776, 0.36: -1.521729482220279, 0.415: -1.7602386720041125, 0.47: -1.9116481656280886, 0.5: -1.9686698504690245, 0.525: -2.0056078338799948, 0.58: -2.0602994608006857, 0.635: -2.0875571038348326, 0.69: -2.0954649275175576, 0.745: -2.089727240383001, 0.8: -2.0744294796343627, 0.855: -2.0525032394177103, 0.9099999999999999: -2.026067329140836, 0.9650000000000001: -1.9967024387419867, 1.0: -1.9770774831774416, 1.02: -1.9656797404380988, 1.075: -1.934252592880839, 1.13: -1.9042202957843781, 1.185: -1.8797738057783187, 1.24: -1.8708275844255908, 1.295: -1.8807538878706114, 1.35: -1.8977548674184679, 1.405: -1.9150215778012691, 1.46: -1.9307696061778068, 1.5: -1.9410485503286317, 1.5150000000000001: -1.9446478497144284, 1.5699999999999998: -1.9567020261705548, 1.625: -1.967088349553929, 1.6800000000000002: -1.9759921298586338, 1.735: -1.9835959307986977, 1.79: -1.9900687982598666, 1.845: -1.995562868125909, 1.9: -2.0002115913576026, 1.955: -2.0041357177144157, 2.0: -2.006880935632776, 2.01: -2.0074394323069944, 2.0650000000000004: -2.010210948585954, 2.12: -2.0125272250617146, 2.175: -2.014456694901475, 2.23: -2.0160574589221785, 2.285: -2.0173794476324716, 2.34: -2.0184654859529556, 2.395: -2.0193522361107545, 2.45: -2.0200710297802145, 2.5: -2.0206013040849595, 2.505: -2.0206485995348236, 2.56: -2.021107718971525, 2.6149999999999998: -2.0214677604001414, 2.67: -2.021745178641316, 2.725: -2.0219539291462114, 2.7800000000000002: -2.0221058282567177, 2.835: -2.0222108629351387, 2.8899999999999997: -2.022277456703894, 2.945: -2.0223126978777404},
"nl-meta-VQE":{0.25: -0.5390968075662849, 0.305: -1.1534234944004773, 0.36: -1.5320231089703154, 0.415: -1.772080382582212, 0.47: -1.9252380310920612, 0.5: -1.9833117523514519, 0.525: -2.0211858820222974, 0.58: -2.0781591859013715, 0.635: -2.108052729637237, 0.69: -2.1190244032134125, 0.745: -2.116858412481447, 0.8: -2.1057166145973265, 0.855: -2.088595692882725, 0.9099999999999999: -2.067639628052807, 0.9650000000000001: -2.044368441788295, 1.0: -2.028855792728656, 1.02: -2.019845456252892, 1.075: -1.9947945195032508, 1.13: -1.9696792000847614, 1.185: -1.9447576514780258, 1.24: -1.9299013928606108, 1.295: -1.956089628011824, 1.35: -1.9777844357143242, 1.405: -1.995844408799017, 1.46: -2.010997881008183, 1.5: -2.0205369859909497, 1.5150000000000001: -2.0238381806393795, 1.5699999999999998: -2.034828306638695, 1.625: -2.044314480284547, 1.6800000000000002: -2.0525461492455204, 1.735: -2.0596991871200045, 1.79: -2.065899059593587, 1.845: -2.0712413342856553, 1.9: -2.075807799358925, 1.955: -2.0796773809033264, 2.0: -2.0823820589020636, 2.01: -2.0829318506973147, 2.0650000000000004: -2.085656921796823, 2.12: -2.087939731576207, 2.175: -2.089863932630697, 2.23: -2.0915036771752007, 2.285: -2.092917710195373, 2.34: -2.09414459919817, 2.395: -2.09519984922038, 2.45: -2.0960753159506074, 2.5: -2.096690288540439, 2.505: -2.0967409791039073, 2.56: -2.097148813993369, 2.6149999999999998: -2.0972382365283075, 2.67: -2.0969424205010085, 2.725: -2.0961947095548337, 2.7800000000000002: -2.094934371963733, 2.835: -2.0931110659423613, 2.8899999999999997: -2.09068757867431, 2.945: -2.087640647857435},
"opt-nl-meta-VQE":{0.25: -0.5399458720816551, 0.305: -1.1540437704373414, 0.36: -1.5324986548046602, 0.415: -1.7724851051855082, 0.47: -1.925523807876501, 0.5: -1.9836160217758625, 0.525: -2.0215220282390547, 0.58: -2.0786675211144123, 0.635: -2.1086322555384007, 0.69: -2.11964074703767, 0.745: -2.1174576781443393, 0.8: -2.106151473819535, 0.855: -2.0888848281487857, 0.9099999999999999: -2.0677655402673265, 0.9650000000000001: -2.044435342760416, 1.0: -2.029075430294417, 1.02: -2.020334456579935, 1.075: -1.9972943460038861, 1.13: -1.9767058660685957, 1.185: -1.960959214787726, 1.24: -1.955026556247531, 1.295: -1.967414466397599, 1.35: -1.9824604564488448, 1.405: -1.997528036371483, 1.46: -2.0113050293373216, 1.5: -2.020739127690863, 1.5150000000000001: -2.024033848218091, 1.5699999999999998: -2.035136084265431, 1.625: -2.044767355627087, 1.6800000000000002: -2.053067892980302, 1.735: -2.060202587868022, 1.79: -2.0663203802700583, 1.845: -2.0715544399570214, 1.9: -2.0760245152551065, 1.955: -2.0798391692069496, 2.0: -2.0825302920992033, 2.01: -2.083057399024843, 2.0650000000000004: -2.0858197092144226, 2.12: -2.0881621423271888, 2.175: -2.090143137339252, 2.23: -2.091811002943205, 2.285: -2.0932184747062923, 2.34: -2.094396988382806, 2.395: -2.095395539094176, 2.45: -2.0962320163900126, 2.5: -2.09686734883856, 2.505: -2.096925208962751, 2.56: -2.0975017329867636, 2.6149999999999998: -2.097980625832011, 2.67: -2.098380059138246, 2.725: -2.09871006756627, 2.7800000000000002: -2.0989831461573454, 2.835: -2.0992085873596467, 2.8899999999999997: -2.0993934610563394, 2.945: -2.0995494656140035},
"exact": {0.25: -0.540546958481916, 0.305: -1.1547147395276456, 0.36: -1.5332509916683579, 0.415: -1.7733261795227442, 0.47: -1.9265692285318936, 0.5: -1.9847119320927784, 0.525: -2.0226523719104783, 0.58: -2.079786783553309, 0.635: -2.109836700079799, 0.69: -2.1209263117181507, 0.745: -2.1188106176567048, 0.8: -2.107640857415319, 0.855: -2.0904461519482576, 0.9099999999999999: -2.069487195459628, 0.9650000000000001: -2.0465541137107697, 1.0: -2.0316656444125085, 1.02: -2.0232529907340795, 1.075: -2.0013358520883564, 1.13: -1.9831238720730662, 1.185: -1.971758378262341, 1.24: -1.9699049014108736, 1.295: -1.9767054620925903, 1.35: -1.9883016812494452, 1.405: -2.0013754487661766, 1.46: -2.014185662809442, 1.5: -2.0228957817495155, 1.5150000000000001: -2.0259993008554713, 1.5699999999999998: -2.0365696243991107, 1.625: -2.045869024379108, 1.6800000000000002: -2.05396554117348, 1.735: -2.060965692305629, 1.79: -2.066987476404658, 1.845: -2.0721475394186815, 1.9: -2.0765552364277466, 1.955: -2.0803101511507127, 2.0: -2.082959396859531, 2.01: -2.083501377402562, 2.0650000000000004: -2.086207696145121, 2.12: -2.0884981935736295, 2.175: -2.0904330774252475, 2.23: -2.092064560545023, 2.285: -2.093437741020523, 2.34: -2.094591441203079, 2.395: -2.0955589863090993, 2.45: -2.0963689137524786, 2.5: -2.096989027447175, 2.505: -2.0970456104924153, 2.56: -2.0976098794040494, 2.6149999999999998: -2.098079437995676, 2.67: -2.0984693542285298, 2.725: -2.0987924250163443, 2.7800000000000002: -2.0990595033507042, 2.835: -2.0992797800225844, 2.8899999999999997: -2.099461025676078, 2.945: -2.099609798518493},
}


do_plot(data, filename)

